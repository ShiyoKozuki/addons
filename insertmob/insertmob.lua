addon.name      = 'InsertMob';
addon.author    = 'Thorny';
addon.version   = '1.00';
addon.desc      = 'Adds monsters to zone entity list dats.';
addon.link      = 'https://github.com/ThornyFFXI/';

require('common');
local chat = require('chat');
local settings = {
    CreateBackups = false,
    ClientPath = 'C:\\Ashita 4\\Client\\FINAL FANTASY XI\\',
    DatPath = 'C:\\Ashita 4\\polplugins\\DATs\\MobDats\\',
};

-- Table to store SQL insert statements
local pendingEntries = T{}

local function TestSQL()
    local ecosystems = {
    [0] = "ERROR",
    [1] = "AMORPH",
    [2] = "AQUAN",
    [3] = "ARCANA",
    [4] = "ARCHAICMACHINE",
    [5] = "AVATAR",
    [6] = "BEAST",
    [7] = "BEASTMEN",
    [8] = "BIRD",
    [9] = "DEMON",
    [10] = "DRAGON",
    [11] = "ELEMENTAL",
    [12] = "EMPTY",
    [13] = "HUMANOID",
    [14] = "LIZARD",
    [15] = "LUMORIAN",
    [16] = "LUMINION",
    [17] = "PLANTOID",
    [18] = "UNCLASSIFIED",
    [19] = "UNDEAD",
    [20] = "VERMIN",
    [21] = "VORAGEAN",
}

local sql_lines = [[
INSERT INTO `spell_list` VALUES (513,'venom_shell',0x0000000000000000000000000000002A000000000000,3,0,6,0,4,43,86,1000,45000,84,271,700,2000,8,0,1.00,1,320,0,30,'TOAU',1.0,2);
INSERT INTO `spell_list` VALUES (515,'maelstrom',0x0000000000000000000000000000003D000000000000,3,0,6,0,4,43,162,1500,39000,2,252,690,2000,8,0,1.00,0,0,0,65,'TOAU',1.0,2);
INSERT INTO `spell_list` VALUES (517,'metallic_body',0x00000000000000000000000000000008000000000000,3,0,4,0,1,43,19,3000,60000,230,0,638,2000,6,0,1.00,1,300,0,0,'TOAU',1.0,2);
INSERT INTO `spell_list` VALUES (519,'screwdriver',0x0000000000000000000000000000001A000000000000,3,0,0,0,4,43,21,250,14000,2,0,642,2000,0,0,1.00,0,0,0,30,'TOAU',1.6,2);
INSERT INTO `spell_list` VALUES (521,'mp_drainkiss',0x0000000000000000000000000000002A000000000000,3,0,8,0,4,43,20,4000,90000,228,275,664,2000,0,0,1.00,320,0,0,200,'TOAU',1.0,1);
INSERT INTO `spell_list` VALUES (522,'death_ray',0x00000000000000000000000000000022000000000000,3,0,8,0,4,43,49,4500,29250,2,252,701,2000,0,0,1.00,0,0,0,200,'TOAU',1.0,1);
INSERT INTO `spell_list` VALUES (524,'sandspin',0x00000000000000000000000000000001000000000000,3,0,4,0,4,43,10,1500,45000,2,252,631,2000,8,0,1.00,0,0,0,30,'TOAU',1.0,1);
INSERT INTO `spell_list` VALUES (527,'smite_of_rage',0x00000000000000000000000000000022000000000000,3,0,0,0,4,43,28,250,13000,2,0,683,2000,0,0,1.00,0,0,0,30,'TOAU',1.75,3);
INSERT INTO `spell_list` VALUES (529,'bludgeon',0x00000000000000000000000000000012000000000000,3,0,0,0,4,43,16,250,11750,2,0,643,2000,0,0,1.00,0,0,0,30,'TOAU',1.55,3);
INSERT INTO `spell_list` VALUES (530,'refueling',0x00000000000000000000000000000030000000000000,3,0,3,0,1,43,29,1500,30000,230,0,718,2000,6,0,1.00,1,300,0,0,'TOAU',1.0,3);
INSERT INTO `spell_list` VALUES (531,'ice_break',0x00000000000000000000000000000032000000000000,3,0,2,0,4,43,142,1500,33750,2,252,721,2000,1,0,1.00,0,0,0,200,'TOAU',1.0,3);
INSERT INTO `spell_list` VALUES (532,'blitzstrahl',0x0000000000000000000000000000002C000000000000,3,0,5,0,4,43,70,4500,29250,2,252,697,2000,0,0,1.00,0,0,0,200,'TOAU',1.0,3);
INSERT INTO `spell_list` VALUES (533,'self-destruct',0x00000000000000000000000000000032000000000000,3,0,1,0,4,43,100,3250,21000,2,252,673,2000,8,0,1.00,0,0,0,30,'TOAU',1.0,3);
INSERT INTO `spell_list` VALUES (534,'mysterious_light',0x00000000000000000000000000000028000000000000,3,0,3,0,4,43,73,1500,24500,2,252,695,2000,1,0,1.00,0,0,0,200,'TOAU',1.0,3);
INSERT INTO `spell_list` VALUES (535,'cold_wave',0x00000000000000000000000000000034000000000000,3,0,2,0,4,43,37,1000,60000,2,252,726,2000,8,0,1.00,320,320,0,30,'TOAU',1.0,3);
INSERT INTO `spell_list` VALUES (536,'poison_breath',0x00000000000000000000000000000016000000000000,3,0,6,0,4,43,22,1500,19500,2,265,660,2000,8,0,1.00,0,0,0,140,'TOAU',1.0,3);
INSERT INTO `spell_list` VALUES (537,'stinking_gas',0x0000000000000000000000000000002C000000000000,3,0,3,0,4,43,37,1000,60000,237,268,715,2000,8,0,1.00,320,320,0,30,'TOAU',1.0,19);
INSERT INTO `spell_list` VALUES (538,'memento_mori',0x0000000000000000000000000000003E000000000000,3,0,2,0,1,43,46,3500,120000,230,0,735,2000,6,0,1.00,320,320,0,0,'TOAU',1.0,19);
INSERT INTO `spell_list` VALUES (539,'terror_touch',0x00000000000000000000000000000028000000000000,3,0,0,0,4,43,62,250,21000,2,0,677,2000,0,0,1.00,0,0,0,30,'TOAU',1.05,19);
INSERT INTO `spell_list` VALUES (540,'spinal_cleave',0x0000000000000000000000000000003F000000000000,3,0,0,0,4,43,61,250,28500,2,0,757,2000,0,0,1.00,0,0,0,94,'TOAU',2.5,19);
INSERT INTO `spell_list` VALUES (541,'blood_saber',0x00000000000000000000000000000030000000000000,3,0,8,0,4,43,25,1500,45000,227,274,661,2000,8,0,1.00,0,0,0,30,'TOAU',1.0,19);
INSERT INTO `spell_list` VALUES (542,'digest',0x00000000000000000000000000000024000000000000,3,0,7,0,4,43,20,1000,26000,227,274,662,2000,0,0,1.00,0,0,0,200,'TOAU',1.0,19);
INSERT INTO `spell_list` VALUES (543,'mandibular_bite',0x0000000000000000000000000000002C000000000000,3,0,0,0,4,43,38,250,19250,2,0,719,2000,0,0,1.00,0,0,0,30,'TOAU',1.75,20);
INSERT INTO `spell_list` VALUES (544,'cursed_sphere',0x00000000000000000000000000000012000000000000,3,0,6,0,4,43,36,1000,19500,2,252,685,2000,1,0,1.00,0,0,0,200,'TOAU',1.0,20);
INSERT INTO `spell_list` VALUES (545,'sickle_slash',0x00000000000000000000000000000030000000000000,3,0,0,0,4,43,41,250,20250,2,0,698,2000,0,0,1.00,0,0,0,30,'TOAU',1.75,20);
INSERT INTO `spell_list` VALUES (547,'cocoon',0x00000000000000000000000000000008000000000000,3,0,4,0,1,43,10,1750,60000,230,0,654,2000,6,0,1.00,1,80,0,0,'TOAU',1.0,20);
INSERT INTO `spell_list` VALUES (548,'filamented_hold',0x00000000000000000000000000000034000000000000,3,0,4,0,4,43,38,2000,20000,84,271,723,2000,2,0,1.00,1,320,0,80,'TOAU',1.0,20);
INSERT INTO `spell_list` VALUES (549,'pollen',0x00000000000000000000000000000001000000000000,3,0,7,0,1,43,8,2000,5000,7,0,650,2000,0,0,1.00,0,0,0,0,'TOAU',1.0,20);
INSERT INTO `spell_list` VALUES (551,'power_attack',0x00000000000000000000000000000004000000000000,3,0,0,0,4,43,5,250,7250,2,0,675,2000,0,0,1.00,0,0,0,30,'TOAU',1.8,20);
INSERT INTO `spell_list` VALUES (554,'death_scissors',0x0000000000000000000000000000003C000000000000,3,0,0,0,4,43,51,250,24500,2,0,681,2000,0,0,1.00,0,0,0,30,'TOAU',1.7,20);
INSERT INTO `spell_list` VALUES (555,'magnetite_cloud',0x0000000000000000000000000000002E000000000000,3,0,4,0,4,43,86,2000,29250,2,265,711,2000,2,0,1.00,0,0,0,124,'TOAU',1.0,0);
INSERT INTO `spell_list` VALUES (557,'eyes_on_me',0x0000000000000000000000000000003D000000000000,3,0,8,0,4,43,112,4500,29250,2,252,704,2000,0,0,1.00,0,0,0,200,'TOAU',1.0,9);
INSERT INTO `spell_list` VALUES (560,'frenetic_rip',0x0000000000000000000000000000003F000000000000,3,0,0,0,4,43,61,250,28500,2,0,748,2000,0,0,1.00,0,0,0,30,'TOAU',1.4,9);
INSERT INTO `spell_list` VALUES (561,'frightful_roar',0x00000000000000000000000000000032000000000000,3,0,3,0,4,43,32,2000,20000,237,271,716,2000,8,0,1.00,1,320,0,30,'TOAU',1.0,9); -- MB msg was 268
INSERT INTO `spell_list` VALUES (563,'hecatomb_wave',0x00000000000000000000000000000036000000000000,3,0,3,0,4,43,116,2000,33750,2,265,732,2000,8,0,1.00,0,0,0,124,'TOAU',1.0,9);
INSERT INTO `spell_list` VALUES (564,'body_slam',0x0000000000000000000000000000003E000000000000,3,0,0,0,4,43,74,1000,27750,2,0,733,2000,8,0,1.00,0,0,0,30,'TOAU',2.0,10);
INSERT INTO `spell_list` VALUES (565,'radiant_breath',0x00000000000000000000000000000036000000000000,3,0,7,0,4,43,116,2000,33750,2,265,722,2000,2,0,1.00,0,0,0,140,'TOAU',1.0,10);
INSERT INTO `spell_list` VALUES (567,'helldive',0x00000000000000000000000000000010000000000000,3,0,0,0,4,43,16,250,11250,2,0,652,2000,0,0,1.00,0,0,0,30,'TOAU',1.85,8);
INSERT INTO `spell_list` VALUES (569,'jet_stream',0x00000000000000000000000000000026000000000000,3,0,0,0,4,43,47,250,23000,2,0,634,2000,0,0,1.00,0,0,0,124,'TOAU',1.25,8);
INSERT INTO `spell_list` VALUES (570,'blood_drain',0x00000000000000000000000000000014000000000000,3,0,8,0,4,43,10,1000,26000,227,274,635,2000,0,0,1.00,0,0,0,200,'TOAU',1.0,8);
INSERT INTO `spell_list` VALUES (572,'sound_blast',0x00000000000000000000000000000020000000000000,3,0,1,0,4,43,25,4000,30000,237,268,761,2000,1,0,1.00,1,320,0,200,'TOAU',1.0,8);
INSERT INTO `spell_list` VALUES (573,'feather_tickle',0x00000000000000000000000000000040000000000000,3,0,2,0,4,43,48,1500,26000,0,0,746,2000,6,0,1.00,1,320,0,200,'TOAU',1.0,8);
INSERT INTO `spell_list` VALUES (574,'feather_barrier',0x00000000000000000000000000000038000000000000,3,0,3,0,1,43,29,2000,120000,230,0,731,2000,6,0,1.00,1,300,0,0,'TOAU',1.0,8);
INSERT INTO `spell_list` VALUES (575,'jettatura',0x00000000000000000000000000000030000000000000,3,0,8,0,4,43,37,250,56000,84,271,720,2000,2,0,1.00,180,1020,0,80,'TOAU',1.0,8);
INSERT INTO `spell_list` VALUES (576,'yawn',0x00000000000000000000000000000040000000000000,3,0,7,0,4,43,55,3000,60000,84,271,749,2000,1,0,1.00,320,320,0,30,'TOAU',1.0,8);
INSERT INTO `spell_list` VALUES (577,'foot_kick',0x00000000000000000000000000000001000000000000,3,0,0,0,4,43,5,250,6500,2,0,639,2000,0,0,1.00,0,0,0,30,'TOAU',2.0,6);
INSERT INTO `spell_list` VALUES (578,'wild_carrot',0x0000000000000000000000000000001E000000000000,3,0,7,0,3,43,37,2500,6000,7,0,640,2000,0,0,1.00,0,0,0,200,'TOAU',1.0,6);
INSERT INTO `spell_list` VALUES (579,'voracious_trunk',0x00000000000000000000000000000040000000000000,3,0,3,0,4,43,72,1500,56000,327,0,747,2000,0,0,1.00,320,640,0,100,'TOAU',1.0,6);
INSERT INTO `spell_list` VALUES (581,'healing_breeze',0x00000000000000000000000000000010000000000000,3,0,3,0,1,43,55,4500,15000,7,0,679,2000,8,0,1.00,0,0,0,30,'TOAU',1.0,6);
INSERT INTO `spell_list` VALUES (582,'chaotic_eye',0x00000000000000000000000000000020000000000000,3,0,3,0,4,43,13,1000,10000,84,271,691,2000,0,0,1.00,1,320,0,200,'TOAU',1.0,6);
INSERT INTO `spell_list` VALUES (584,'sheep_song',0x00000000000000000000000000000010000000000000,3,0,7,0,4,43,22,3000,60000,84,271,672,2000,8,0,1.00,320,320,0,30,'TOAU',1.0,6);
INSERT INTO `spell_list` VALUES (585,'ram_charge',0x00000000000000000000000000000049000000000000,3,0,0,0,4,43,79,250,34750,2,0,743,2000,0,0,1.00,0,0,0,30,'TOAU',2.5,6);
INSERT INTO `spell_list` VALUES (587,'claw_cyclone',0x00000000000000000000000000000014000000000000,3,0,0,0,4,43,24,1000,19750,2,0,687,2000,2,0,1.00,0,0,0,137,'TOAU',1.3,6);
INSERT INTO `spell_list` VALUES (588,'lowing',0x00000000000000000000000000000047000000000000,3,0,1,0,4,43,66,7000,56000,84,0,734,2000,8,0,1.00,1,320,0,30,'TOAU',1.0,6);
INSERT INTO `spell_list` VALUES (589,'dimensional_death',0x0000000000000000000000000000003C000000000000,3,0,0,0,4,43,48,250,23750,2,0,745,2000,0,0,1.00,0,0,0,30,'TOAU',1.2,19);
INSERT INTO `spell_list` VALUES (591,'heat_breath',0x00000000000000000000000000000047000000000000,3,0,1,0,4,43,169,2000,49000,2,265,729,2000,2,0,1.00,0,0,0,140,'TOAU',1.0,6);
INSERT INTO `spell_list` VALUES (592,'blank_gaze',0x00000000000000000000000000000026000000000000,3,0,7,0,4,43,25,1000,10000,0,0,707,2000,0,0,1.00,320,320,0,200,'TOAU',1.0,6);
INSERT INTO `spell_list` VALUES (593,'magic_fruit',0x0000000000000000000000000000003A000000000000,3,0,7,0,3,43,72,2500,6000,7,0,708,2000,0,0,1.00,0,0,0,200,'TOAU',1.0,6);
INSERT INTO `spell_list` VALUES (594,'uppercut',0x00000000000000000000000000000026000000000000,3,0,0,0,4,43,31,250,17750,2,0,692,2000,0,0,1.00,0,0,0,30,'TOAU',1.6,17);
INSERT INTO `spell_list` VALUES (595,'1000_needles',0x0000000000000000000000000000003E000000000000,3,0,7,0,4,43,175,2000,56000,2,252,724,2000,8,0,1.00,0,0,0,30,'TOAU',1.6,17);
INSERT INTO `spell_list` VALUES (596,'pinecone_bomb',0x00000000000000000000000000000024000000000000,3,0,0,0,4,43,48,2500,26500,2,0,710,2000,0,0,1.00,0,0,0,200,'TOAU',1.6,17);
INSERT INTO `spell_list` VALUES (597,'sprout_smack',0x00000000000000000000000000000004000000000000,3,0,0,0,4,43,6,250,7250,2,0,653,2000,0,0,1.00,0,0,0,30,'TOAU',1.0,17);
INSERT INTO `spell_list` VALUES (598,'soporific',0x00000000000000000000000000000018000000000000,3,0,8,0,4,43,38,3000,26000,84,271,682,2000,8,0,1.00,320,320,0,30,'TOAU',1.0,17);
INSERT INTO `spell_list` VALUES (599,'queasyshroom',0x00000000000000000000000000000008000000000000,3,0,0,0,4,43,20,2000,15000,2,0,669,2000,0,0,1.00,0,0,0,200,'TOAU',1.5,17);
INSERT INTO `spell_list` VALUES (603,'wild_oats',0x00000000000000000000000000000004000000000000,3,0,0,0,4,43,9,250,7250,2,0,656,2000,0,0,1.00,0,0,0,200,'TOAU',1.0,17);
INSERT INTO `spell_list` VALUES (604,'bad_breath',0x0000000000000000000000000000003D000000000000,3,0,4,0,4,43,212,2000,56000,2,265,694,2000,2,0,1.00,0,0,0,140,'TOAU',1.0,17);
INSERT INTO `spell_list` VALUES (605,'geist_wall',0x0000000000000000000000000000002E000000000000,3,0,8,0,4,43,35,1000,30000,0,0,703,2000,8,0,1.00,320,320,0,30,'TOAU',1.0,14);
INSERT INTO `spell_list` VALUES (606,'awful_eye',0x0000000000000000000000000000002E000000000000,3,0,6,0,4,43,32,1500,60000,237,268,709,2000,2,0,1.00,1,180,0,80,'TOAU',1.0,14);
INSERT INTO `spell_list` VALUES (608,'frost_breath',0x00000000000000000000000000000042000000000000,3,0,2,0,4,43,136,2000,42750,2,265,688,2000,2,0,1.00,0,0,0,140,'TOAU',1.0,14);
INSERT INTO `spell_list` VALUES (610,'infrasonics',0x00000000000000000000000000000041000000000000,3,0,2,0,4,43,42,1000,60000,237,268,633,2000,2,0,1.00,1,320,0,30,'TOAU',1.0,14);
INSERT INTO `spell_list` VALUES (611,'disseverment',0x00000000000000000000000000000048000000000000,3,0,0,0,4,43,74,250,32750,2,0,738,2000,0,0,1.00,0,0,0,30,'TOAU',1.05,15);
INSERT INTO `spell_list` VALUES (612,'actinic_burst',0x0000000000000000000000000000004A000000000000,3,0,7,0,4,43,24,250,60000,237,268,741,2000,8,0,1.00,180,1020,0,30,'TOAU',1.0,16);
INSERT INTO `spell_list` VALUES (613,'reactor_cool',0x0000000000000000000000000000004A000000000000,3,0,2,0,1,43,28,3000,60000,230,0,742,2000,6,0,1.00,1,480,0,0,'TOAU',1.0,16);
INSERT INTO `spell_list` VALUES (614,'saline_coat',0x00000000000000000000000000000048000000000000,3,0,7,0,1,43,66,3000,180000,230,0,737,2000,6,0,1.00,1,480,0,0,'TOAU',1.0,15);
INSERT INTO `spell_list` VALUES (615,'plasma_charge',0x0000000000000000000000000000004B000000000000,3,0,5,0,1,43,24,3000,60000,230,0,740,2000,6,0,1.00,1,480,0,0,'TOAU',1.0,15);
INSERT INTO `spell_list` VALUES (616,'temporal_shift',0x00000000000000000000000000000049000000000000,3,0,5,0,4,43,48,250,56000,84,271,736,2000,8,0,1.00,180,1020,0,30,'TOAU',1.0,15);
INSERT INTO `spell_list` VALUES (617,'vertical_cleave',0x0000000000000000000000000000004B000000000000,3,0,0,0,4,43,86,250,37250,2,0,739,2000,0,0,1.00,0,0,0,30,'TOAU',1.5,15);
INSERT INTO `spell_list` VALUES (618,'blastbomb',0x00000000000000000000000000000012000000000000,3,0,1,0,4,43,36,2250,15000,2,252,674,2000,1,0,1.00,0,0,0,143,'TOAU',1.0,7);
INSERT INTO `spell_list` VALUES (620,'battle_dance',0x0000000000000000000000000000000C000000000000,3,0,0,0,4,43,12,1000,10000,2,0,668,2000,8,0,1.00,0,0,0,30,'TOAU',1.0,7);
INSERT INTO `spell_list` VALUES (621,'sandspray',0x00000000000000000000000000000042000000000000,3,0,8,0,4,43,43,1000,26000,84,271,751,2000,2,0,1.00,0,0,0,200,'TOAU',1.0,7);
INSERT INTO `spell_list` VALUES (622,'grand_slam',0x0000000000000000000000000000001E000000000000,3,0,0,0,4,43,24,1000,14250,2,0,696,2000,8,0,1.00,0,0,0,30,'TOAU',1.6,7);
INSERT INTO `spell_list` VALUES (623,'head_butt',0x0000000000000000000000000000000C000000000000,3,0,5,0,4,43,12,250,10000,2,0,665,2000,0,0,1.00,0,0,0,30,'TOAU',1.05,7);
INSERT INTO `spell_list` VALUES (626,'bomb_toss',0x0000000000000000000000000000001C000000000000,3,0,1,0,4,43,42,1000,24500,2,252,645,2000,0,0,1.00,0,0,0,200,'TOAU',1.0,7);
INSERT INTO `spell_list` VALUES (628,'frypan',0x0000000000000000000000000000003F000000000000,3,0,0,0,4,43,65,1000,26000,2,0,646,2000,8,0,1.00,0,0,0,30,'TOAU',1.0,7);
INSERT INTO `spell_list` VALUES (629,'flying_hip_press',0x0000000000000000000000000000003A000000000000,3,0,5,0,4,43,125,2000,34500,2,265,725,2000,8,0,1.00,0,0,0,30,'TOAU',1.0,7);
INSERT INTO `spell_list` VALUES (631,'hydro_shot',0x0000000000000000000000000000003F000000000000,3,0,0,0,4,43,55,250,26000,2,0,714,2000,0,0,1.00,0,0,0,200,'TOAU',1.85,7);
INSERT INTO `spell_list` VALUES (632,'diamondhide',0x00000000000000000000000000000043000000000000,3,0,4,0,1,43,99,7000,90000,230,0,753,2000,8,0,1.00,1,300,0,100,'TOAU',1.0,7);
INSERT INTO `spell_list` VALUES (633,'enervation',0x00000000000000000000000000000043000000000000,3,0,8,0,4,43,48,3500,60000,237,0,754,2000,8,0,1.00,1,320,0,100,'TOAU',1.0,7);
INSERT INTO `spell_list` VALUES (634,'light_of_penance',0x0000000000000000000000000000003A000000000000,3,0,7,0,4,43,53,1500,24500,0,252,727,2000,0,0,1.00,1,640,0,200,'TOAU',1.0,7);
INSERT INTO `spell_list` VALUES (636,'warm-up',0x00000000000000000000000000000044000000000000,3,0,4,0,1,43,59,3000,56000,230,0,752,2000,6,0,1.00,320,320,0,0,'TOAU',1.0,7);
INSERT INTO `spell_list` VALUES (637,'firespit',0x00000000000000000000000000000044000000000000,3,0,1,0,4,43,121,3000,30000,2,252,758,2000,0,0,1.00,0,0,0,200,'TOAU',1.0,7);
INSERT INTO `spell_list` VALUES (638,'feather_storm',0x0000000000000000000000000000000C000000000000,3,0,0,0,4,43,12,250,10000,2,0,648,2000,0,0,1.00,0,0,0,147,'TOAU',1.0,7);
INSERT INTO `spell_list` VALUES (640,'tail_slap',0x00000000000000000000000000000045000000000000,3,0,0,0,4,43,77,1000,28500,2,0,756,2000,1,0,1.00,0,0,0,124,'TOAU',1.05,7);
INSERT INTO `spell_list` VALUES (641,'hysteric_barrage',0x00000000000000000000000000000045000000000000,3,0,0,0,4,43,61,250,28500,2,0,755,2000,0,0,1.00,0,0,0,30,'TOAU',1.0,7);
INSERT INTO `spell_list` VALUES (642,'amplification',0x00000000000000000000000000000046000000000000,3,0,6,0,1,43,48,2000,60000,230,0,760,2000,6,0,1.00,320,320,0,200,'TOAU',1.0,1);
INSERT INTO `spell_list` VALUES (643,'cannonball',0x00000000000000000000000000000046000000000000,3,0,0,0,4,43,66,250,28500,2,0,759,2000,0,0,1.00,0,0,0,225,'TOAU',1.0,20);
INSERT INTO `spell_list` VALUES (644,'mind_blast',0x00000000000000000000000000000049000000000000,3,0,5,0,4,43,82,3000,30000,2,252,762,2000,0,0,1.00,0,0,0,200,'TOAU',1.0,9);
INSERT INTO `spell_list` VALUES (645,'exuviation',0x0000000000000000000000000000004B000000000000,3,0,1,0,1,43,40,1000,60000,7,0,763,2000,6,0,1.00,640,640,0,0,'TOAU',1.0,20);
INSERT INTO `spell_list` VALUES (646,'magic_hammer',0x0000000000000000000000000000004A000000000000,3,0,7,0,4,43,40,4000,180000,228,252,764,2000,0,0,1.00,0,0,0,200,'TOAU',1.0,7);
INSERT INTO `spell_list` VALUES (647,'zephyr_mantle',0x00000000000000000000000000000041000000000000,3,0,3,0,1,43,31,4000,60000,230,0,765,2000,6,0,1.00,320,320,0,0,'TOAU',1.0,10);
INSERT INTO `spell_list` VALUES (648,'regurgitation',0x00000000000000000000000000000045000000000000,3,0,6,0,4,43,69,3000,24500,2,252,770,2000,0,0,1.00,1,640,0,200,'TOAU',1.0,14);
INSERT INTO `spell_list` VALUES (650,'seedspray',0x0000000000000000000000000000003D000000000000,3,0,0,0,4,43,61,250,36000,2,0,771,2000,0,0,1.00,1,640,0,140,'TOAU',1.5,17);
INSERT INTO `spell_list` VALUES (651,'corrosive_ooze',0x00000000000000000000000000000042000000000000,3,0,6,0,4,43,55,3500,30000,2,252,768,2000,8,0,1.00,1,640,0,200,'TOAU',1.0,1);
INSERT INTO `spell_list` VALUES (652,'spiral_spin',0x0000000000000000000000000000003C000000000000,3,0,0,0,4,43,39,250,45000,2,0,772,2000,0,0,1.00,0,0,0,140,'TOAU',1.75,20);
INSERT INTO `spell_list` VALUES (653,'asuran_claws',0x00000000000000000000000000000046000000000000,3,0,0,0,4,43,81,2000,60000,2,0,769,2000,0,0,1.00,0,0,0,30,'TOAU',1.05,6);
INSERT INTO `spell_list` VALUES (654,'sub-zero_smash',0x00000000000000000000000000000048000000000000,3,0,0,0,4,43,44,1000,32750,2,0,790,2000,1,0,1.00,0,0,0,30,'TOAU',1.85,2);
INSERT INTO `spell_list` VALUES (655,'triumphant_roar',0x00000000000000000000000000000047000000000000,3,0,1,0,1,43,36,1750,26000,230,0,789,2000,6,0,1.00,320,320,0,0,'TOAU',1.0,9);
INSERT INTO `spell_list` VALUES (656,'acrid_stream',0x0000000000000000000000000000004D000000000000,3,0,6,0,4,43,89,3000,23000,2,0,791,2000,2,0,1.00,0,0,0,30,'ABYSSEA',1.0,21);
INSERT INTO `spell_list` VALUES (657,'blazing_bound',0x00000000000000000000000000000050000000000000,3,0,1,0,4,43,113,4000,45000,2,0,792,2000,0,0,1.00,0,0,0,200,'ABYSSEA',1.0,21);
INSERT INTO `spell_list` VALUES (658,'plenilune_embrace',0x0000000000000000000000000000004000000000000,3,0,7,0,3,43,106,2750,12000,7,0,793,2000,0,0,1.00,0,0,0,200,'ABYSSEA',1.0,6);
INSERT INTO `spell_list` VALUES (659,'demoralizing_roar',0x00000000000000000000000000000047000000000000,3,0,6,0,4,43,46,2750,25000,237,0,794,2000,8,0,1.00,1,320,0,100,'ABYSSEA',1.0,14);
INSERT INTO `spell_list` VALUES (660,'cimicine_discharge',0x0000000000000000000000000000004E000000000000,3,0,4,0,4,43,32,1500,20000,237,0,795,2000,8,0,1.00,1,320,0,100,'ABYSSEA',1.0,20);
INSERT INTO `spell_list` VALUES (661,'animating_wail',0x0000000000000000000000000000004B000000000000,3,0,3,0,1,43,53,2000,45000,230,0,799,2000,6,0,1.00,320,320,0,0,'ABYSSEA',1.0,19);
INSERT INTO `spell_list` VALUES (662,'battery_charge',0x00000000000000000000000000000029000000000000,3,0,7,0,1,43,50,3500,11000,230,0,798,2000,6,0,1.00,320,320,0,0,'ABYSSEA',1.0,3);
INSERT INTO `spell_list` VALUES (663,'leafstorm',0x0000000000000000000000000000004D000000000000,3,0,3,0,4,43,132,6000,1000,2,0,796,2000,8,0,1.00,0,0,0,100,'ABYSSEA',1.0,17);
INSERT INTO `spell_list` VALUES (664,'regeneration',0x0000000000000000000000000000003D000000000000,3,0,7,0,1,43,36,1500,60000,230,0,797,2000,6,0,1.00,320,320,0,0,'ABYSSEA',1.0,2);
INSERT INTO `spell_list` VALUES (665,'final_sting',0x0000000000000000000000000000004B000000000000,3,0,0,0,4,43,88,5000,11000,2,0,651,2000,0,0,1.00,0,0,0,30,'ABYSSEA',1.0,20);
INSERT INTO `spell_list` VALUES (666,'goblin_rush',0x0000000000000000000000000000004B000000000000,3,0,0,0,4,43,76,250,25500,2,0,644,2000,0,0,1.00,0,0,0,30,'ABYSSEA',1.66,7);
INSERT INTO `spell_list` VALUES (667,'vanity_dive',0x0000000000000000000000000000004B000000000000,3,0,0,0,4,43,58,250,42250,2,0,802,2000,0,0,1.00,0,0,0,30,'ABYSSEA',1.66,12);
INSERT INTO `spell_list` VALUES (668,'magic_barrier',0x00000000000000000000000000000052000000000000,3,0,8,0,1,43,29,5000,60000,230,0,803,2000,6,0,1.00,0,0,0,0,'ABYSSEA',1.0,9);
INSERT INTO `spell_list` VALUES (669,'whirl_of_rage',0x0000000000000000000000000000004B000000000000,3,0,0,0,4,43,73,1000,31000,2,0,684,2000,8,0,1.00,0,0,0,30,'ABYSSEA',1.0,3);
INSERT INTO `spell_list` VALUES (670,'benthic_typhoon',0x00000000000000000000000000000053000000000000,3,0,0,0,4,43,56,250,48000,2,0,801,2000,2,0,1.00,0,0,0,30,'ABYSSEA',1.0,21);
INSERT INTO `spell_list` VALUES (671,'auroral_drape',0x0000000000000000000000000000004B000000000000,3,0,3,0,4,43,51,4000,60000,84,0,804,2000,8,0,1.00,1,320,0,100,'ABYSSEA',1.0,21);
INSERT INTO `spell_list` VALUES (672,'osmosis',0x00000000000000000000000000000054000000000000,3,0,8,0,4,43,47,6000,56000,227,0,800,2000,0,0,1.00,0,0,0,200,'ABYSSEA',1.0,21);
INSERT INTO `spell_list` VALUES (673,'quad_continuum',0x0000000000000000000000000000004B000000000000,3,0,0,0,4,43,91,1000,31750,2,0,805,2000,0,0,1.00,0,0,0,30,'ABYSSEA',1.05,12);
INSERT INTO `spell_list` VALUES (674,'fantod',0x00000000000000000000000000000055000000000000,3,0,1,0,1,43,12,250,10000,230,0,806,2000,6,0,1.00,320,320,0,0,'ABYSSEA',1.0,8);
INSERT INTO `spell_list` VALUES (675,'thermal_pulse',0x0000000000000000000000000000004B000000000000,3,0,1,0,4,43,151,5500,8000,2,0,827,2000,8,0,1.00,0,0,0,100,'ABYSSEA',1.0,20);
INSERT INTO `spell_list` VALUES (677,'empty_thrash',0x0000000000000000000000000000004B000000000000,3,0,0,0,4,43,33,250,40750,2,0,828,2000,2,0,1.00,0,0,0,30,'ABYSSEA',1.5,12);
INSERT INTO `spell_list` VALUES (678,'dream_flower',0x00000000000000000000000000000057000000000000,3,0,8,0,4,43,68,2000,45000,84,0,655,2000,8,0,1.00,0,0,0,100,'ABYSSEA',1.0,17);
INSERT INTO `spell_list` VALUES (679,'occultation',0x0000000000000000000000000000004B000000000000,3,0,3,0,1,43,138,1500,26000,230,0,829,2000,6,0,1.00,320,320,0,30,'ABYSSEA',1.0,10);
INSERT INTO `spell_list` VALUES (680,'charged_whisker',0x0000000000000000000000000000004B000000000000,3,0,5,0,4,43,183,5000,23000,2,0,830,2000,8,0,1.00,0,0,0,100,'ABYSSEA',1.0,6);
INSERT INTO `spell_list` VALUES (681,'winds_of_promy',0x00000000000000000000000000000059000000000000,3,0,7,0,1,43,36,2500,17500,0,0,831,2000,8,0,1.00,640,640,0,100,'ABYSSEA',1.0,12);
INSERT INTO `spell_list` VALUES (682,'delta_thrust',0x0000000000000000000000000000004B000000000000,3,0,0,0,4,43,28,250,15000,2,0,832,2000,0,0,1.00,0,0,0,30,'ABYSSEA',1.0,14);
INSERT INTO `spell_list` VALUES (683,'evryones_grudge',0x0000000000000000000000000000004B000000000000,3,0,8,0,4,43,185,6000,18500,2,0,728,2000,0,0,1.00,0,0,0,200,'ABYSSEA',1.0,7);
INSERT INTO `spell_list` VALUES (684,'reaving_wind',0x0000000000000000000000000000005A000000000000,3,0,3,0,4,43,84,4000,26000,0,0,833,2000,8,0,1.00,1,320,0,100,'ABYSSEA',1.0,8);
INSERT INTO `spell_list` VALUES (685,'barrier_tusk',0x0000000000000000000000000000005B000000000000,3,0,4,0,1,43,41,5000,60000,230,0,837,2000,0,0,1.00,320,320,0,0,'ABYSSEA',1.0,6);
INSERT INTO `spell_list` VALUES (686,'mortal_ray',0x0000000000000000000000000000005B000000000000,3,0,8,0,4,43,267,8500,22000,84,0,838,2000,0,0,1.00,640,640,0,30,'ABYSSEA',1.0,9);
INSERT INTO `spell_list` VALUES (687,'water_bomb',0x0000000000000000000000000000005C000000000000,3,0,6,0,4,43,67,2500,32250,2,0,843,2000,1,0,1.00,0,0,0,124,'ABYSSEA',1.0,7);
INSERT INTO `spell_list` VALUES (688,'heavy_strike',0x0000000000000000000000000000004B000000000000,3,0,0,0,4,43,32,250,28000,2,0,842,2000,0,0,1.00,0,0,0,30,'ABYSSEA',1.0,3);
INSERT INTO `spell_list` VALUES (689,'dark_orb',0x0000000000000000000000000000005D000000000000,3,0,8,0,4,43,124,7000,8000,2,0,841,2000,0,0,1.00,0,0,0,200,'ABYSSEA',1.0,9);
INSERT INTO `spell_list` VALUES (690,'white_wind',0x0000000000000000000000000000005E000000000000,3,0,3,0,1,43,145,4500,22500,7,0,750,2000,8,0,1.00,0,0,0,100,'ABYSSEA',1.0,10);
INSERT INTO `spell_list` VALUES (692,'sudden_lunge',0x0000000000000000000000000000005F000000000000,3,0,0,0,4,43,18,250,15000,2,0,840,2000,0,0,1.00,0,0,0,30,'ABYSSEA',1.0,20);
INSERT INTO `spell_list` VALUES (693,'quadrastrike',0x00000000000000000000000000000060000000000000,3,0,0,0,4,43,98,250,42500,2,0,848,2000,0,0,1.00,0,0,0,30,'ABYSSEA',1.0,9);
INSERT INTO `spell_list` VALUES (694,'vapor_spray',0x00000000000000000000000000000060000000000000,3,0,6,0,4,43,172,3000,19000,2,0,849,2000,2,0,1.00,0,0,0,140,'ABYSSEA',1.0,15);
INSERT INTO `spell_list` VALUES (695,'thunder_breath',0x00000000000000000000000000000061000000000000,3,0,5,0,4,43,193,7000,48000,2,265,850,2000,2,0,1.00,0,0,0,140,'ABYSSEA',1.0,10);
INSERT INTO `spell_list` VALUES (696,'orcish_counterstance',0x00000000000000000000000000000062000000000000,3,0,1,0,1,43,18,4000,11000,230,0,851,2000,0,0,1.00,320,320,0,0,'ABYSSEA',1.0,7);
INSERT INTO `spell_list` VALUES (697,'amorphic_spikes',0x00000000000000000000000000000062000000000000,3,0,0,0,4,43,79,250,58250,2,0,852,2000,0,0,1.00,0,0,0,30,'ABYSSEA',1.0,1);
INSERT INTO `spell_list` VALUES (698,'wind_breath',0x00000000000000000000000000000063000000000000,3,0,3,0,4,43,26,1000,29500,2,265,853,2000,2,0,1.00,0,0,0,140,'ABYSSEA',1.0,10);
INSERT INTO `spell_list` VALUES (699,'barbed_crescent',0x0000000000000000000000000000004B000000000000,3,0,0,0,4,43,52,250,22000,2,0,854,2000,0,0,1.00,0,0,0,30,'ABYSSEA',1.75,19);
INSERT INTO `spell_list` VALUES (700,'natures_meditation',0x00000000000000000000000000000063000000000000,3,0,1,0,4,43,52,250,22000,2,0,907,2000,0,0,1.00,320,320,0,30,'ABYSSEA',1.0,20);
INSERT INTO `spell_list` VALUES (701,'tempestuous_upheaval',0x0000000000000000000000000000004B000000000000,3,0,3,0,4,43,52,250,22000,2,0,908,2000,8,0,1.00,0,0,0,200,'ABYSSEA',1.0,20);
INSERT INTO `spell_list` VALUES (702,'rending_deluge',0x00000000000000000000000000000063000000000000,3,0,6,0,4,43,52,250,22000,2,0,909,2000,8,0,1.00,0,0,0,200,'ABYSSEA',1.0,2);
INSERT INTO `spell_list` VALUES (703,'embalming_earth',0x00000000000000000000000000000063000000000000,3,0,4,0,4,43,52,250,22000,2,0,910,2000,8,0,1.00,0,0,0,1204,'ABYSSEA',1.0,14);
INSERT INTO `spell_list` VALUES (704,'paralyzing_triad',0x0000000000000000000000000000004B000000000000,3,0,0,0,4,43,52,250,22000,2,0,911,2000,0,0,1.00,0,0,0,30,'ABYSSEA',1.0,11);
INSERT INTO `spell_list` VALUES (705,'foul_waters',0x00000000000000000000000000000063000000000000,3,0,6,0,4,43,52,250,22000,2,0,912,2000,2,0,1.00,0,0,0,200,'ABYSSEA',1.0,1);
INSERT INTO `spell_list` VALUES (706,'glutinous_dart',0x0000000000000000000000000000004B000000000000,3,0,0,0,4,43,52,250,22000,2,0,913,2000,0,0,1.00,0,0,0,200,'ABYSSEA',1.0,7);
INSERT INTO `spell_list` VALUES (707,'retinal_glare',0x0000000000000000000000000000004B000000000000,3,0,7,0,4,43,52,250,22000,2,0,914,2000,0,0,1.00,0,0,0,200,'ABYSSEA',1.0,17);
INSERT INTO `spell_list` VALUES (708,'subduction',0x00000000000000000000000000000063000000000000,3,0,3,0,4,43,52,250,22000,2,0,925,2000,8,0,1.00,0,0,0,124,'ABYSSEA',1.0,3);
INSERT INTO `spell_list` VALUES (709,'thrashing_assault',0x00000000000000000000000000000063000000000000,3,0,0,0,4,43,52,250,22000,2,0,926,2000,0,0,1.00,0,0,0,30,'ABYSSEA',1.0,7);
INSERT INTO `spell_list` VALUES (710,'erratic_flutter',0x00000000000000000000000000000063000000000000,3,0,3,0,4,43,52,250,22000,2,0,924,2000,0,0,1.00,320,320,0,30,'ABYSSEA',1.0,20); -- Wrong animation ID?
INSERT INTO `spell_list` VALUES (711,'restoral',0x0000000000000000000000000000004B000000000000,3,0,7,0,1,43,52,2000,22000,2,0,940,2000,0,0,1.00,0,0,0,30,'ABYSSEA',1.0,4);
INSERT INTO `spell_list` VALUES (712,'rail_cannon',0x0000000000000000000000000000004B000000000000,3,0,7,0,4,43,52,2250,22000,2,0,941,2000,0,0,1.00,0,0,0,200,'ABYSSEA',1.0,4);
INSERT INTO `spell_list` VALUES (713,'diffusion_ray',0x0000000000000000000000000000004B000000000000,3,0,7,0,4,43,52,4000,22000,2,0,942,2000,2,0,1.00,0,0,0,200,'ABYSSEA',1.0,4);
INSERT INTO `spell_list` VALUES (714,'sinker_drill',0x0000000000000000000000000000004B000000000000,3,0,0,0,4,43,52,250,22000,2,0,943,2000,0,0,1.00,0,0,0,30,'ABYSSEA',1.05,3);
INSERT INTO `spell_list` VALUES (736,'thunderbolt',0x0000000000000000000000000000004B000000000000,3,0,5,0,4,43,138,3500,120000,2,0,844,2000,1,0,1.00,0,0,16,100,'ABYSSEA',1.0,6);
INSERT INTO `spell_list` VALUES (737,'harden_shell',0x0000000000000000000000000000004B000000000000,3,0,4,0,1,43,20,1500,120000,230,0,845,2000,6,0,1.00,320,320,16,0,'ABYSSEA',1.0,14);
INSERT INTO `spell_list` VALUES (738,'absolute_terror',0x0000000000000000000000000000004B000000000000,3,0,8,0,4,43,29,250,120000,84,0,855,2000,0,0,1.00,960,1800,16,50,'ABYSSEA',1.0,10);
INSERT INTO `spell_list` VALUES (739,'gates_of_hades',0x0000000000000000000000000000004B000000000000,3,0,1,0,4,43,156,3500,120000,2,0,856,2000,1,0,1.00,0,0,16,100,'ABYSSEA',1.0,6);
INSERT INTO `spell_list` VALUES (740,'tourbillion',0x0000000000000000000000000000004B000000000000,3,0,0,0,4,43,108,1000,120000,2,0,857,2000,1,0,1.00,0,0,16,140,'ABYSSEA',1.0,3);
INSERT INTO `spell_list` VALUES (741,'pyric_bulwark',0x0000000000000000000000000000004B000000000000,3,0,2,0,1,43,50,1500,120000,230,0,858,2000,6,0,1.00,320,320,16,0,'ABYSSEA',1.0,10);
INSERT INTO `spell_list` VALUES (742,'bilgestorm',0x0000000000000000000000000000004B000000000000,3,0,0,0,4,43,122,1000,120000,2,0,859,2000,1,0,1.00,0,0,16,100,'ABYSSEA',1.0,9);
INSERT INTO `spell_list` VALUES (743,'bloodrake',0x0000000000000000000000000000004B000000000000,3,0,0,0,4,43,99,250,120000,2,0,860,2000,0,0,1.00,0,0,16,50,'ABYSSEA',5.0,19);
INSERT INTO `spell_list` VALUES (744,'droning_whirlwind',0x0000000000000000000000000000004B000000000000,3,0,3,0,4,43,224,1500,120000,2,0,915,2000,1,0,1.00,0,0,16,100,'SOA',1.0,20);
INSERT INTO `spell_list` VALUES (745,'carcharian_verve',0x0000000000000000000000000000004B000000000000,3,0,6,0,1,43,65,1000,120000,2,0,916,2000,6,0,1.00,320,320,16,0,'SOA',1.0,2);
INSERT INTO `spell_list` VALUES (746,'blistering_roar',0x0000000000000000000000000000004B000000000000,3,0,1,0,4,43,43,500,120000,2,0,917,2000,1,0,1.00,640,960,16,100,'SOA',1.0,14);
INSERT INTO `spell_list` VALUES (747,'uproot',0x0000000000000000000000000000004B000000000000,3,0,7,0,4,43,88,1500,120000,2,0,944,2000,1,0,1.00,320,320,16,100,'SOA',1.0,17);
INSERT INTO `spell_list` VALUES (748,'crashing_Thunder',0x0000000000000000000000000000004B000000000000,3,0,5,0,4,43,172,1000,120000,2,0,945,2000,1,0,1.00,0,0,16,100,'SOA',1.0,8);
INSERT INTO `spell_list` VALUES (749,'polar_roar',0x0000000000000000000000000000004B000000000000,3,0,2,0,4,43,126,3000,120000,2,0,946,2000,1,0,1.00,0,0,16,100,'SOA',1.0,6);
INSERT INTO `spell_list` VALUES (750,'mighty_guard',0x0000000000000000000000000000004B000000000000,3,0,7,0,1,43,229,3000,120000,2,0,1002,2000,6,0,1.00,320,320,16,0,'SOA',1.0,10);
INSERT INTO `spell_list` VALUES (751,'cruel_joke',0x0000000000000000000000000000004B000000000000,3,0,8,0,4,43,187,3000,120000,2,0,1003,2000,1,0,1.00,640,640,16,100,'SOA',1.0,19);
INSERT INTO `spell_list` VALUES (752,'cesspool',0x0000000000000000000000000000004B000000000000,3,0,6,0,4,43,166,3000,120000,2,0,1004,2000,1,0,1.00,0,0,16,100,'SOA',1.0,1);
INSERT INTO `spell_list` VALUES (753,'tearing_gust',0x0000000000000000000000000000004B000000000000,3,0,3,0,4,43,202,3000,120000,2,0,1005,2000,1,0,1.00,0,0,16,100,'SOA',1.0,11);
]]


    for line in sql_lines:gmatch("[^\r\n]+") do
        local parts = {}
        -- Strip leading SQL, split CSV
        local values = line:match("%((.+)%)")
        for value in values:gmatch("[^,]+") do
            value = value:gsub("^%s*", ""):gsub("%s*$", "") -- trim
            table.insert(parts, value)
        end

        local id = parts[1]
        local name = parts[2]:gsub("'", "") -- remove quotes
        local eco_id = tonumber(parts[#parts])
        local eco_name = ecosystems[eco_id] or ("UNKNOWN(" .. tostring(eco_id) .. ")")

        print(string.format("%s: %s -> %s", id, name, eco_name))
    end
end

local function Error(text)
    local stripped = string.gsub(text, '$H', ''):gsub('$R', '');
    LogManager:Log(1, addon.name, stripped);
    local color = ('\30%c'):format(68);
    local highlighted = color .. string.gsub(text, '$H', '\30\01\30\02');
    highlighted = string.gsub(highlighted, '$R', '\30\01' .. color);
    print(chat.header(addon.name) .. highlighted .. '\30\01');
end

local function Message(text)
    local stripped = string.gsub(text, '$H', ''):gsub('$R', '');
    LogManager:Log(5, addon.name, stripped);
    local color = ('\30%c'):format(106);
    local highlighted = color .. string.gsub(text, '$H', '\30\01\30\02');
    highlighted = string.gsub(highlighted, '$R', '\30\01' .. color);
    print(chat.header(addon.name) .. highlighted .. '\30\01');
end

local function MatchWithoutSymbols(a, b)
    if (a == b) then
        return true;
    end

    local left = string.lower(a:gsub('%W', ''));
    local right = string.lower(b:gsub('%W', ''));
    return (left == right);
end

local function GetDatPath(zoneId)
    local datId;
    if (zoneId < 256) then
        datId = zoneId + 6720;
    elseif (zoneId < 1000) then
        datId = zoneId + 86235;
    else
        datId = zoneId + 66911;
    end
    
    local clientPath = settings.ClientPath;
    for i = 1,10 do
        local vTablePath;
        if i == 1 then
            vTablePath = string.format('%sVTABLE.DAT', clientPath);
        else
            vTablePath = string.format('%sROM%u\\VTABLE%u.DAT', clientPath, i, i);
        end
        local vTable = io.open(vTablePath, 'rb');
        if vTable then
            vTable:seek('set', datId);
            local temp = struct.unpack('B', vTable:read(1));
            if temp == i then
                local fTablePath;
                if i == 1 then
                    fTablePath = string.format('%sFTABLE.DAT', clientPath);
                else
                    fTablePath = string.format('%sROM%u\\FTABLE%u.DAT', clientPath, i, i);
                end
                local fTable = io.open(fTablePath, 'rb');

                if fTable then
                    fTable:seek('set', datId * 2);
                    local data = fTable:read(2);
                    local path = struct.unpack('H', data);
                    if i == 1 then
                        return string.format('%sROM\\%u\\%u.DAT', settings.DatPath, bit.rshift(path, 7), bit.band(path, 0x7F));
                    else
                        return string.format('%sROM%u\\%u\\%u.DAT', settings.DatPath, i, bit.rshift(path, 7), bit.band(path, 0x7F));                        
                    end
                end
            end
        end
    end
    return nil;
end

local function LoadEntityDat(filePath)
    if not ashita.fs.exists(filePath) then
        Error('File does not exist: ' .. filePath);
        return;
    end

    local dat = io.open(filePath, 'rb');
    if not dat then
        Error('Failed to open file for reading: ' .. filePath);
        return;
    end

    local outputTable = {};

    local data = dat:read('*all');
    local offset = 1;
    while (offset < #data) do
        local entityName = struct.unpack('c28', data, offset);
        local entityId = struct.unpack('L', data, offset + 28);
        local entityIndex = bit.band(entityId, 0x7FF);
        if (entityId > 0) and (entityIndex > 0) then
            outputTable[entityIndex] = { Name = entityName, Id = entityId, Index = entityIndex };
        end
        
        offset = offset + 32;
    end
    dat:close();

    return outputTable;
end

local function WriteEntityDat(filePath, data)
    local out = io.open(filePath, 'wb');
    if (out == nil) then
        Error('Failed to open file for writing: ' .. filePath);
        return;
    end

    out:write(struct.pack('c32', 'none' .. string.rep('\x00', 28)));

    for i = 0,1024 do
        local entityData = data[i];
        if entityData then
            local outString = struct.pack('c28L', entityData.Name, entityData.Id);
            out:write(outString);
        end
    end

    out:close();
    Message('Wrote file: ' .. filePath);
end

local function AddMob(zoneId, mobName)
    local path = GetDatPath(zoneId);
    if (path == nil) then
        Error("Could not locate entity dat for zone ID: " .. zoneId);
        return;
    end

    local data = LoadEntityDat(path);
    if (data == nil) then
        Error("Could not load entity dat: " .. path);
        return;
    end

    local highestIndex = 0;
    local zoneBase;
    for index, data in pairs(data) do
        if (data.Index > highestIndex) then
            zoneBase = bit.band(data.Id, 0xFFFFF800);
            highestIndex = data.Index;
        end
    end
    if zoneBase == nil then
        Error('Failed to locate zone base.');
        return;
    end
    if (highestIndex == 0) then
        Error('Zone dat has no monsters.');
        return;
    end
    if (highestIndex > 0x3FE) then
        Error('Zone dat has no remaining space.');
        return;
    end

    if (settings.CreateBackups) then
        local lastDirectory = string.find(path, "\\[^\\]*$");
        if lastDirectory then
            local writeDirectory = string.sub(path, 1, lastDirectory - 1) .. '_backups';
            if (not ashita.fs.exists(writeDirectory)) then
                ashita.fs.create_directory(writeDirectory);
            end
            local fileBase = string.sub(path, lastDirectory + 1, -5);
            local writeFile = fileBase .. '.bak';
            local writePath = writeDirectory .. '\\' .. writeFile;
            local index = 0;
            while (ashita.fs.exists(writePath)) do
                writeFile = fileBase .. '.bak' .. tostring(index);
                writePath = writeDirectory .. '\\' .. writeFile;
                index = index + 1;
            end
            WriteEntityDat(writePath, data);
        else
            Error('Could not create backup path.');
            return;
        end
    end

    local index = highestIndex + 1;
    local len = string.len(mobName);
    if len < 28 then
        mobName = mobName .. string.rep('\x00', 28 - len);
    end
    data[index] = { Name=mobName, Id=zoneBase + index, Index=index };
    Message(string.format('Inserted mob[$H%s$R] into dat for $H%s$R.  Index:$H%u$R ID:$H%u$R',
        mobName:trimend('\x00'), AshitaCore:GetResourceManager():GetString('zones.names', zoneId), index, zoneBase+index));

    local insertSql = string.format(
        "INSERT INTO `mob_spawn_points` VALUES (%u, '%s', '%s', 23, 0, 50, 0, 0);",
        zoneBase + index,
        mobName:trimend('\x00'):gsub(" ", "_"),
        mobName:trimend('\x00')
    )

    -- Add the insert SQL statement to the table for cliplua command
    table.insert(pendingEntries, insertSql)

    -- Now that the mob is inserted, save the data
    WriteEntityDat(path, data)

    -- Optionally, return the pendingEntries table if needed
    return pendingEntries
end

ashita.events.register('command', 'command_cb', function (e)
    local args = e.command:args();
    if #args == 0 or (string.lower(args[1]) ~= '/insertmob') then
        return;
    end
    e.blocked = true;

    if (args[2] == 'cliplua') and (#args > 1) then
        ashita.misc.set_clipboard(table.concat(pendingEntries, '\n'));
        pendingEntries = T{}
        Message("All entries copied to clipboard")
        return;
    end

    if (args[2] == 'testsql') and (#args > 1) then
        TestSQL()
    end

    if (#args < 3) then
        return;
    end

    local zoneId = -1;
    for i = 1,350 do
        local zoneString = AshitaCore:GetResourceManager():GetString('zones.names', i);
        if zoneString and MatchWithoutSymbols(zoneString, args[2]) then
            zoneId = i;
            break;
        end
    end

    if (zoneId == -1) then
        Error("Could not find zone: " .. args[2]);
        return;
    end

    local amountToAdd = tonumber(args[4]) or 1
    for i = 1, amountToAdd do
        AddMob(zoneId, args[3]);
    end
end);